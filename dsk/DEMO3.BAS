10 REM GAME
20 _SPRDISABLE:DEFINT A-Z:COLOR 15,1,4:SCREEN 2,2,0
30 A=0:I=0:J=0:K=0:O=0:SU=0:A$="":X=0:Y#=0:VY#=0:AC#=0:F=0:EX=0:EY=0
40 DIM SA(3,31):DIM AD(3):DIM AS(5):DIM SG(2,2):DIM AR(2):DIM AL(2):DIM PL(24,31)
50 _MAXANIMSPRS(0):_MAXANIMDEFS(0):_MAXANIMITEMS(0)
60 _MAXANIMITEMS(24):_MAXANIMDEFS(10):_MAXANIMSPRS(10)

1000 BLOAD"OUT.SC2",S
1480 REM PLATFORM
1490 RESTORE 30000:FOR I=0 TO 7:READ A:VPOKE BASE(12)+2040+I,A:VPOKE BASE(11)+2040+I,&H1F:VPOKE BASE(12)+4088+I,A:VPOKE BASE(11)+4088+I,&H1F:VPOKE BASE(12)+6136+I,A:VPOKE BASE(11)+6136+I,&H1F:NEXT
1500 REM PLAYER CHARACTER SPRITES 0-17
1510 O=BASE(14):GOSUB 41100
1520 REM EDITOR POINTER SPRITE 18
1530 O=BASE(14)+18*32:FOR I=0 TO 7:VPOKE O+I,255:NEXT
1550 REM DEFINE SPRITE GROUP
1560 SG(0,0)=0:SG(1,0)=0:SG(2,0)=0
1570 SG(0,1)=1:SG(1,1)=0:SG(2,1)=0
1580 SG(0,2)=2:SG(1,2)=0:SG(2,2)=0
1590 REM DEFINE ANIMATIONS
1600 REM RIGHT DIRECTION FIRST
1610 REM BLACK
1620 _ANIMITEMPAT(0,3,0,1):_ANIMITEMPAT(1,3,3,1):_ANIMITEMPAT(2,3,6,1)
1630 REM BLUE
1640 _ANIMITEMPAT(3,3,1,4):_ANIMITEMPAT(4,3,4,4):_ANIMITEMPAT(5,3,7,4)
1650 REM WHITE
1660 _ANIMITEMPAT(6,3,2,15):_ANIMITEMPAT(7,3,5,15):_ANIMITEMPAT(8,3,8,15)
1670 REM LEFT DIRECTION
1680 REM BLACK
1690 _ANIMITEMPAT(9,3,9,1):_ANIMITEMPAT(10,3,12,1):_ANIMITEMPAT(11,3,15,1)
1700 REM BLUE
1710 _ANIMITEMPAT(12,3,10,4):_ANIMITEMPAT(13,3,13,4):_ANIMITEMPAT(14,3,16,4)
1720 REM WHITE
1730 _ANIMITEMPAT(15,3,11,15):_ANIMITEMPAT(16,3,14,15):_ANIMITEMPAT(17,3,17,15)
1731 REM EDITOR POINTER
1732 _ANIMITEMPAT(18,25,18,15):_ANIMITEMPAT(19,25,18,0)
1740 REM ANIMATION DEFINITION - RIGHT BLACK
1750 AD(0)=0:AD(1)=1:AD(2)=2:AD(3)=1:_ANIMDEF(0,4,AD)
1760 REM ANIMATION DEFINITION - RIGHT BLUE
1770 AD(0)=3:AD(1)=4:AD(2)=5:AD(3)=4:_ANIMDEF(1,4,AD)
1780 REM ANIMATION DEFINITION - RIGHT WHITE
1790 AD(0)=6:AD(1)=7:AD(2)=8:AD(3)=7:_ANIMDEF(2,4,AD)
1800 REM ANIMATION DEFINITION - LEFT BLACK
1810 AD(0)=9:AD(1)=10:AD(2)=11:AD(3)=10:_ANIMDEF(3,4,AD)
1820 REM ANIMATION DEFINITION - LEFT BLUE
1830 AD(0)=12:AD(1)=13:AD(2)=14:AD(3)=13:_ANIMDEF(4,4,AD)
1840 REM ANIMATION DEFINITION - LEFT WHITE
1850 AD(0)=15:AD(1)=16:AD(2)=17:AD(3)=16:_ANIMDEF(5,4,AD)
1854 REM EDITOR POINTER ANIMATION DEFINITION
1855 AD(0)=18:AD(1)=19:_ANIMDEF(6,2,AD)
1860 REM SPRITE ANIMATION RIGHT BLACK
1870 _ANIMSPRITE(0,0,0,1)
1880 REM SPRITE ANIMATION RIGHT BLUE
1890 _ANIMSPRITE(1,1,1,1)
1900 REM SPRITE ANIMATION RIGHT WHITE
1910 _ANIMSPRITE(2,2,2,1)
1920 REM SPRITE ANIMATION LEFT BLACK
1930 _ANIMSPRITE(3,0,3,1)
1940 REM SPRITE ANIMATION LEFT BLUE
1950 _ANIMSPRITE(4,1,4,1)
1960 REM SPRITE ANIMATION LEFT WHITE
1970 _ANIMSPRITE(5,2,5,1)
1971 _ANIMSPRITE(6,3,6,1)
1972 ON ERROR GOTO 1976
1973 BLOAD"LEVEL.BIN",VARPTR(PL(0,0))
1974 O=BASE(10):FOR J=0 TO 23:FOR I=0 TO 31:IF PL(J,I)>0 THEN VPOKE O,255
1975 O=O+1:NEXT I,J:GOTO 1980
1976 BEEP:BEEP:BEEP
1980 _SPRENABLE (SA,SU,0)
1990 FOR I=0 TO 31:_SPRSET (I,256,256,I,4):PL(24,I)=1:NEXT
2000 X=120:Y#=112:AC#=0.1:VY#=0
2010 SA(0,0)=Y:SA(1,0)=X:SA(2,0)=0:SA(3,0)=1
2020 SA(0,1)=Y:SA(1,1)=X:SA(2,1)=1:SA(3,1)=4
2030 SA(0,2)=Y:SA(1,2)=X:SA(2,2)=2:SA(3,2)=15
2035 SA(0,3)=0:SA(1,3)=0:SA(2,3)=18:SA(3,3)=15
2040 _SPRGRPMOV(X,INT(Y#),3,SG):SU=1
2050 _ANIMSTART(6)
2060 ON STOP GOSUB 7000:STOP ON
2070 ON ERROR GOTO 7000
2080 AR(0)=0:AR(1)=1:AR(2)=2
2090 AL(0)=3:AL(1)=4:AL(2)=5

3000 IF STRIG(1)=-1 THEN GOSUB 10000
3005 IF STRIG(3)=-1 THEN GOSUB 11000
3010 ON STICK(1)+1 GOTO 3500,3020,3030,3040,3050,3060,3070,3080,3090
3020 EY=EY-1:GOTO 3100
3030 EX=EX+1:EY=EY-1:GOTO 3100
3040 EX=EX+1:GOTO 3100
3050 EX=EX+1:EY=EY+1:GOTO 3100
3060 EY=EY+1:GOTO 3100
3070 EX=EX-1:EY=EY+1:GOTO 3100
3080 EX=EX-1:GOTO 3100
3090 EX=EX-1:EY=EY-1
3100 IF EX<0 THEN EX=0
3110 IF EX>31 THEN EX=31
3120 IF EY<0 THEN EY=0
3130 IF EY>23 THEN EY=23
3140 SA(0,3)=EY*8:SA(1,3)=EX*8:SU=1

3500 IF STRIG(0)=-1 AND F=0 THEN F=1:VY#=-2.5
3510 I=X\8:J=INT(Y#)\8
3511 IF VY#=0 AND (PL(J+2,I)>0 OR PL(J+2,I+1)>0) GOTO 3530
3520 K=INT(Y#+VY#)\8:IF K>J AND VY#>0 AND (PL(K+2,I)>0 OR PL(K+2,I+1)>0) THEN VY#=0:F=0:Y#=K*8 ELSE Y#=Y#+VY#:VY#=VY#+AC#
3530 ON STICK(0)+1 GOTO 3580,3580,3540,3540,3540,3580,3560,3560,3560
3540 X=X+1:IF X>240 THEN X=240
3550 _SGAM(X,INT(Y#),3,SG,3,AR):GOTO 3000
3560 X=X-1:IF X<0 THEN X=0
3570 _SGAM(X,INT(Y#),3,SG,3,AL):GOTO 3000
3580 _SPRGRPMOV(X,INT(Y#),3,SG):SU=1:GOTO 3000

7000 _ANIMSTOP(6):_SPRDISABLE
7010 SCREEN 0
7020 END

10000 REM TOGGLE PLATFORM
10010 IF PL(EY,EX)=0 THEN A=1:K=255 ELSE A=0:K=0
10020 PL(EY,EX)=A:VPOKE BASE(10)+EY*32+EX,K
10030 IF STRIG(1)=-1 THEN 10030
10040 RETURN

11000 REM SAVE PLATFORMS
11010 BSAVE"LEVEL.BIN",VARPTR(PL(0,0)),VARPTR(PL(0,0))+1599
11020 IF STRIG(3)=-1 THEN 11020
11030 RETURN

30000 REM PLATFORM
30010 DATA &HFF,0,&HFF,0,&HFF,0,&HFF,0

40000 ' --- R1
40010 ' color 1
40020 DATA &H07,&H08,&H08,&H04,&H04,&H06,&H08,&H10
40030 DATA &H2C,&H4C,&H34,&H04,&H09,&H16,&H24,&H18
40040 DATA &HC0,&H20,&H20,&H20,&H40,&HFC,&H02,&H3C
40050 DATA &H20,&H20,&H20,&H20,&H90,&H50,&H48,&H30
40060 ' color 4
40070 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H03
40080 DATA &H01,&H01,&H01,&H00,&H00,&H00,&H00,&H00
40090 DATA &H00,&H00,&H80,&H00,&H00,&H00,&H00,&H80
40100 DATA &H80,&H80,&H80,&H00,&H00,&H00,&H00,&H00
40110 ' color 15
40120 DATA &H00,&H07,&H07,&H03,&H03,&H01,&H07,&H0C
40130 DATA &H12,&H32,&H02,&H03,&H06,&H08,&H18,&H00
40140 DATA &H00,&HC0,&H40,&HC0,&H80,&H00,&HFC,&H40
40150 DATA &H40,&H40,&H40,&HC0,&H60,&H20,&H30,&H00
40160 ' 
40170 ' --- R2
40180 ' color 1
40190 DATA &H07,&H08,&H08,&H04,&H04,&H06,&H08,&H08
40200 DATA &H10,&H10,&H0C,&H04,&H05,&H05,&H09,&H0E
40210 DATA &HC0,&H20,&H20,&H20,&H40,&HE0,&H10,&H08
40220 DATA &H24,&H38,&H20,&H20,&HA0,&HA0,&H90,&HF0
40230 ' color 4
40240 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H03
40250 DATA &H03,&H03,&H01,&H00,&H00,&H00,&H00,&H00
40260 DATA &H00,&H00,&H80,&H00,&H00,&H00,&H00,&HC0
40270 DATA &H80,&H80,&H80,&H00,&H00,&H00,&H00,&H00
40280 ' color 15
40290 DATA &H00,&H07,&H07,&H03,&H03,&H01,&H07,&H04
40300 DATA &H0C,&H0C,&H02,&H03,&H02,&H02,&H06,&H00
40310 DATA &H00,&HC0,&H40,&HC0,&H80,&H00,&HE0,&H30
40320 DATA &H58,&H40,&H40,&HC0,&H40,&H40,&H60,&H00
40330 ' 
40340 ' --- R3
40350 ' color 1
40360 DATA &H07,&H08,&H08,&H04,&H04,&H06,&H08,&H08
40370 DATA &H08,&H08,&H04,&H04,&H04,&H04,&H09,&H07
40380 DATA &HC0,&H20,&H20,&H20,&H40,&HE0,&H10,&H10
40390 DATA &H10,&H10,&H20,&H20,&H40,&H40,&H20,&HC0
40400 ' color 4
40410 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H03
40420 DATA &H03,&H03,&H01,&H01,&H01,&H00,&H00,&H00
40430 DATA &H00,&H00,&H80,&H00,&H00,&H00,&H00,&HC0
40440 DATA &HC0,&HC0,&H80,&H00,&H00,&H00,&H00,&H00
40450 ' color 15
40460 DATA &H00,&H07,&H07,&H03,&H03,&H01,&H07,&H04
40470 DATA &H04,&H04,&H02,&H02,&H02,&H03,&H06,&H00
40480 DATA &H00,&HC0,&H40,&HC0,&H80,&H00,&HE0,&H20
40490 DATA &H20,&H20,&H40,&HC0,&H80,&H80,&HC0,&H00
40500 ' 
40510 ' --- L1
40520 ' color 1
40530 DATA &H03,&H04,&H04,&H04,&H02,&H3F,&H40,&H3C
40540 DATA &H04,&H04,&H04,&H04,&H09,&H0A,&H12,&H0C
40550 DATA &HE0,&H10,&H10,&H20,&H20,&H60,&H10,&H08
40560 DATA &H34,&H32,&H2C,&H20,&H90,&H68,&H24,&H18
40570 ' color 4
40580 DATA &H00,&H00,&H01,&H00,&H00,&H00,&H00,&H01
40590 DATA &H01,&H01,&H01,&H00,&H00,&H00,&H00,&H00
40600 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&HC0
40610 DATA &H80,&H80,&H80,&H00,&H00,&H00,&H00,&H00
40620 ' color 15
40630 DATA &H00,&H03,&H02,&H03,&H01,&H00,&H3F,&H02
40640 DATA &H02,&H02,&H02,&H03,&H06,&H04,&H0C,&H00
40650 DATA &H00,&HE0,&HE0,&HC0,&HC0,&H80,&HE0,&H30
40660 DATA &H48,&H4C,&H40,&HC0,&H60,&H10,&H18,&H00
40670 ' 
40680 ' --- L2
40690 ' color 1
40700 DATA &H03,&H04,&H04,&H04,&H02,&H07,&H08,&H10
40710 DATA &H24,&H1C,&H04,&H04,&H05,&H05,&H09,&H0F
40720 DATA &HE0,&H10,&H10,&H20,&H20,&H60,&H10,&H10
40730 DATA &H08,&H08,&H30,&H20,&HA0,&HA0,&H90,&H70
40740 ' color 4
40750 DATA &H00,&H00,&H01,&H00,&H00,&H00,&H00,&H03
40760 DATA &H01,&H01,&H01,&H00,&H00,&H00,&H00,&H00
40770 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&HC0
40780 DATA &HC0,&HC0,&H80,&H00,&H00,&H00,&H00,&H00
40790 ' color 15
40800 DATA &H00,&H03,&H02,&H03,&H01,&H00,&H07,&H0C
40810 DATA &H1A,&H02,&H02,&H03,&H02,&H02,&H06,&H00
40820 DATA &H00,&HE0,&HE0,&HC0,&HC0,&H80,&HE0,&H20
40830 DATA &H30,&H30,&H40,&HC0,&H40,&H40,&H60,&H00
40840 ' 
40850 ' --- L3
40860 ' color 1
40870 DATA &H03,&H04,&H04,&H04,&H02,&H07,&H08,&H08
40880 DATA &H08,&H08,&H04,&H04,&H02,&H02,&H04,&H03
40890 DATA &HE0,&H10,&H10,&H20,&H20,&H60,&H10,&H10
40900 DATA &H10,&H10,&H20,&H20,&H20,&H20,&H90,&HE0
40910 ' color 4
40920 DATA &H00,&H00,&H01,&H00,&H00,&H00,&H00,&H03
40930 DATA &H03,&H03,&H01,&H00,&H00,&H00,&H00,&H00
40940 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&HC0
40950 DATA &HC0,&HC0,&H80,&H80,&H80,&H00,&H00,&H00
40960 ' color 15
40970 DATA &H00,&H03,&H02,&H03,&H01,&H00,&H07,&H04
40980 DATA &H04,&H04,&H02,&H03,&H01,&H01,&H03,&H00
40990 DATA &H00,&HE0,&HE0,&HC0,&HC0,&H80,&HE0,&H20
41000 DATA &H20,&H20,&H40,&H40,&H40,&HC0,&H60,&H00
41010 DATA -1
41100 REM -- LOAD SPRITES
41120 RESTORE 40000
41130 READ A: IF A=-1 THEN RETURN ELSE VPOKE O,A:O=O+1:GOTO 41130
